# Изменения в версии 081120252116

## Дата: 08.11.2025 21:16

## Добавлено

### Экспорт данных тренда в формат Excel (xlsx)

Добавлена возможность экспорта данных завершенного цикла итерации в формат Microsoft Excel (.xlsx).

#### Новые элементы:

1. **Кнопка "Экспорт в Excel"** на дашборде (в группе "График")
   - Расположена рядом с кнопкой "Экспорт тренда"
   - Позволяет экспортировать данные в формат Excel после завершения цикла

2. **Узел подготовки Excel экспорта**
   - Использует библиотеку `xlsx` для создания Excel файлов
   - Формирует структурированные данные с тремя колонками:
     - Timestamp (временная метка)
     - Value (значение итерации)
     - Step (номер шага)
   - Автоматически устанавливает ширину столбцов для удобства чтения
   - Сохраняет данные на лист "Trend Data"

3. **Узел записи Excel файла**
   - Сохраняет файл в директорию `/data/trends/`
   - Имя файла формируется как: `trend_<версия>_<timestamp>.xlsx`
   - Создает директорию автоматически, если она не существует

#### Технические детали:

- Библиотека `xlsx` загружается через `require('xlsx')` и кэшируется в глобальном контексте
- Файл экспортируется в бинарном формате (encoding: 'none')
- Данные берутся из того же снимка, что и для CSV экспорта
- После экспорта данные очищаются, чтобы избежать дублирования

#### Использование:

1. Запустите цикл итерации
2. Дождитесь завершения цикла (все 5 шагов)
3. Нажмите кнопку "Экспорт в Excel" на дашборде
4. Файл будет сохранен в `/data/trends/trend_081120252116_<дата-время>.xlsx`

## Обновления версии

- Версия проекта: **081120252116**
- Обновлена информация о версии в tab
- Добавлена запись в историю версий
- Обновлены все внутренние ссылки на версию

## Примечания

- Для работы экспорта в Excel необходима установленная библиотека `xlsx` в Node-RED
- Если библиотека не установлена, выполните: `npm install xlsx` в директории Node-RED
- CSV экспорт продолжает работать параллельно с Excel экспортом

## Файлы

- Новый файл проекта: `flows_controller_iteration_ver_081120252116.json`
- Предыдущая версия: `flows_controller_iteration_ver_081120252047.json`
